<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS v5.0.2 -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lobster&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous">
    <link rel="stylesheet" href="/css/buyerlogin.css">
    <title>Ecommerce for Agricultural Product!!!</title>
 </head>
  <body>
    <nav class="navbar navbar-dark bg-success">
        <div>
        <a href="/html/homefinal.html" class="navbar-brand mr-3"><img src="/static/logo.png" width="50%"></a>
        </div>
        <div class="texthyper" >
        <a href="#" class="nav-item nav-link " ></a>
        </div>
        <div class="texthyper">
        <a href="#" class="nav-item nav-link " ></a>
        </div>
        <div class="texthyper">
        <a href="/html/buyersignup.html" class="nav-item nav-link active" style="color:white;">Sign Up</a>
        </div>
        </nav>
    <section>
        <div class="container-fluid contentBx">
            <div class="formBx">
                <h2>Login</h2>
                <form>
                    <div class="inputBx">
                        <span>Email</span>
                        <input type="email" class="form-control" id="inputEmail" onkeyup="checkregmail()">
                    </div>
                    <div class="inputBx">
                        <span>Password</span>
                        <input type="password" class="form-control" id="inputPassword">
                    </div>
                    <div class="inputBx">
                        <input type="submit" value="Sign in" name="" onclick="loginClick()">
                    </div>
                    <div class="inputBx">
                        <p>Don't have an acount? <a href="/html/buyersignup.html">Sign up</a></p>
                    </div>
                </form>
            </div>
        </div>
    </section>
    <script type="text/javascript">


        
        function loginClick(){
            console.log('entered into click');
           
       
            const email=document.getElementById('inputEmail').value;
            const password=document.getElementById('inputPassword').value;
     
             if(email =="" || password==""){
                alert("Email and Password is must")
             }   else
             {
                fetch("http://localhost:3005/buyerRegi/"+email)
            .then(response => response.json())
            .then(data => {
                console.log(data)
                var valu=JSON.stringify(data);
                    if(data[0].email == email && data[0].password == password){

                          alert("login sucess" ); 
                          debugger;
                          localStorage.setItem('idb',data[0]._id);
                          localStorage.setItem('firstnameb',data[0].firstname);
                          localStorage.setItem('lastnameb',data[0].lastname);
                          localStorage.setItem('mailidb',data[0].email);
                          localStorage.setItem('phonenumberb',data[0].phonenumber);
                          localStorage.setItem('pinb',data[0].pincode);
                          localStorage.setItem('passwordb',data[0].password);
                          
                         window.location="/html/Buyer.html";
                      }
                      else{
                          alert("login Failed")
                      }   
                      
            });


             

             }
      
        }


        function checkregmail(){
console.log("entered into check mail");
var decimal=  /^([a-zA-Z0-9_\-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([a-zA-Z0-9\-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/;
const element=document.getElementById('inputEmail');
const email=element.value;
if(email.match(decimal)){
    console.log("match");
    document.getElementById('alertregmail').innerHTML=``;
    document.getElementById('sign').disabled = false;
}
else{
    console.log("notmatch");
    document.getElementById('alertregmail').innerHTML=`enter valid email`;
    document.getElementById('sign').disabled = true;
}
}




    </script>







<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

    </body>
</html>